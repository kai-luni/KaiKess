<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rotation Animation with Button</title>
<style>
    #arrImage {
      position: absolute;
      left: 200px; /* Position arrow in the middle of the wheel */
      width: 100px;
      transform: translateX(-50%); /* Center the arrow horizontally */
    }
    body {
      background-color: white;
      color: black;
    }
      .button-container {
      display: flex;
      justify-content: center; /* Center horizontally */
      align-items: center; /* Center vertically */
      margin-top: 64px;
	  }
    .container {
      display: flex;
      flex-direction: row; /* Lay out children horizontally */
      justify-content: space-around; /* Distribute space around items */
      width: 100%; /* Set container width to full viewport width */
    }
    .text-button-group, .wheel {
      flex: 1; /* Allocate 50% width to each column */
    }
    #btn {
      background-color: transparent;
      background-image: url("button.png");
      background-size: cover;
      margin-top: 20px; /* Space above the button */
      width: 200px;
      height: 200px;
      border: none;
      cursor: pointer;  
    }
    .info-text {
      margin-top: 20px; /* Lower the headline */
    }
    .info-text h2 {
      margin-left: 24px;
      text-align: left; /* Left align the headline */
    }
    .info-text p {
      font-size: 18px; /* Increase the font size of the normal text */
    }
    #radImage {
      position: absolute;
      top: 29px;
      transform-origin: center; /* Set the rotation point to the center of the image */    
      width: 400px; /* Scale the image to fit the container */
    }
    #star 
    {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100px;
      height: 100px;
      background-image: url('rick-roll.gif'); /* Replace with your star image */
      background-size: cover;
      transform-origin: center;
      transform: translate(-50%, -50%) scale(1);
      transition: transform 5s ease-in-out, opacity 2s ease-in-out;
      opacity: 0; /* Start with the star hidden */
      z-index: 10; /* Ensure star is above other elements if necessary */
    }
    .wheel {
      position: relative;
      width: 400px; /* Fixed width */
      height: 430px; /* Fixed height, adjust based on the size of the wheel image */
      margin: auto; /* Center the wheel within its container */
      overflow: hidden; /* Prevents any part of the rotating image from overflowing */
    }
    /* Mobile Responsive Styles */
    @media screen and (max-width: 767px) {
    #arrImage {
      left: 50%; /* Position arrow in the middle of the wheel */
    }
    .container {
        flex-direction: column; /* Stack children vertically */
        align-items: center; /* Center children horizontally */
        overflow: auto; /* Enable scrolling if content exceeds viewport height */
    }
    #radImage {   
      width: 100%; /* Scale the image to fit the container */
    }
    .text-button-group, .wheel {
        flex: none; /* Remove the flex grow/shrink */
        width: 100%; /* Full width for mobile */
        max-width: 800px; /* Limit the maximum width */
        margin-bottom: 20px; /* Add some space below each section */
    }
    .wheel {
        position: relative;
        width: 100%; /* Full width for mobile */
        max-width: 800px; /* Limit the maximum width */
        margin: 0 auto; /* Center align within the container */
        overflow: hidden; /* Keeps the rotating image within bounds */
    }

    #btn {
        width: 150px; /* Smaller button size for mobile */
        height: 150px;
    }
}

</style>
</head>
<body>

<div id="star"></div>

<div class="container">
  <div class="text-button-group">
	<div class="info-text">
	  <br><br><br><br><br>
	  <div>
		<h2>Wie funktioniert die Wichtel-Maschine:</h2>
	  </div>
	  <br><br>
	  <ol>
        <li><p>Klicke auf Start und lass dir von unserer Wichtel-Maschine deinen PHATten Wichtel ausw√§hlen.</p></li>
        <li><p>Im Anschluss √∂ffnet sich ein neues Fenster, in dem du ein bisschen aktiv werden musst.</p></li>
        <li><p><strong>WICHTIG:</strong> Du kannst nur bis zum XX.XX mitmachen, da es sonst zu knapp f√ºr die Wichtel-Magie wird.</p></li>
        <li><p>Am 06.12 darfst du dich auf die Aufl√∂sung und Weihnachtspost freuen! Mitmachen lohnt sich, denn f√ºr alle Teilnehmer:innen gibt es eine √úberraschung f√ºr 2024 üòä</p></li>
      </ol>
    </div>
    <div class="button-container">
      <button id="btn" title="wheel"></button>
    </div>
  
  </div>
  <div class="wheel">
    <img id="radImage" src="rad.png" alt="Rotating Image">
    <img id="arrImage" src="arrow.png" alt="Arrow">
  </div>
</div>
</div>

<script>
  const image = document.getElementById('radImage');
  let angle = Math.random() * 360; // Random angle between 0 and 360 degrees
  image.style.transform = `rotate(${angle}deg)`; // Apply the rotation
  let speed = 0.1; // Initial speed in degrees per millisecond
  let acceleration = 0.1; // Rate at which the speed will increase
  let counter_inbetween = 20;
  let deceleration = 0.015;
  let max_speed = 6.0;
  let slowingDown = false; // A flag to indicate if it's slowing down

  // Assuming you have a function or event for when the wheel stops
  function onWheelStop() {
    // Call the star animation function after the wheel stops
    startStarAnimation();
  }

  function rotateImage(timestamp) {
    if (speed > 0) {
      angle += speed; // Increase the angle by the current speed
      image.style.transform = `rotate(${angle}deg)`; // Apply the rotation
      if (!slowingDown) {
        speed += acceleration;
        if (speed >= max_speed) {
          slowingDown = true;
          acceleration = -deceleration; // Reverse the acceleration
        }
      } else {
        if(counter_inbetween > 0)
        {
          counter_inbetween = counter_inbetween - 1;
        }
        else
        {
          speed += acceleration;
          if (speed <= 0) {
            speed = 0;
          }
        }
      }
      requestAnimationFrame(rotateImage); // Request the next frame of the animation
    } else {
      onWheelStop();
	  }
  }

  // Function to start the star animation
  function startStarAnimation() {
    const star = document.getElementById('star');
    star.style.opacity = '1'; // Show the star

    setTimeout(() => {
      star.style.transform = 'translate(-50%, -50%) scale(30) rotate(360deg)';
    }, 1000);

    setTimeout(() => {
      document.querySelector('.container').style.display = 'none';
    }, 5000);    

    setTimeout(() => {
      star.style.opacity = '0'; // Fade out the star
    }, 6000);

    setTimeout(() => {
      // Call redirection after the animation ends
      window.location.href = "https://www.phatconsulting.de/uncategorized/test-steckbriefmaske/";
    }, 12000);
  }


  const button = document.getElementById('btn');
  var button_clicked = false;
  button.addEventListener('click', function() {    
    if(!button_clicked)
	{
      button.style.backgroundImage = 'url("button_pressed.png")';
      // Add any additional functionality you want to trigger with the button press
	}
	button_clicked = true;
	requestAnimationFrame(rotateImage); // Start the animation
  });
</script>

</body>
</html>
